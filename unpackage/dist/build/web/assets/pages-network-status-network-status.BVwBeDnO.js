import{C as t,c as s,w as a,i as e,o as c,d as r,e as l,u as o,t as u,f as i,k as n,j as d}from"./index-CoNwD4i1.js";import{a as h}from"./api.D7tYKUGc.js";import{_ as k}from"./_plugin-vue_export-helper.BCo6x5W8.js";const f=k({data:()=>({networkStatus:!1,cloudStatus:!1,dbStatus:!1,checking:!1,errorMessage:""}),onLoad(){this.checkNetwork()},methods:{async checkNetwork(){this.checking=!0,this.errorMessage="";try{this.networkStatus=await this.checkBasicNetwork(),this.networkStatus&&(this.cloudStatus=await this.checkCloudFunction(),this.cloudStatus&&(this.dbStatus=await this.checkDatabase()))}catch(t){this.errorMessage=t.message,console.error("网络检测失败:",t)}finally{this.checking=!1}},async checkBasicNetwork(){try{return(await fetch("https://httpbin.org/get",{method:"GET",timeout:5e3})).ok}catch(t){throw new Error("基础网络连接失败")}},async checkCloudFunction(){try{return await h.callFunction("getBills",{limit:1}),!0}catch(t){throw new Error("云函数连接失败: "+t.message)}},async checkDatabase(){try{const t=await h.getBills({limit:1});return t&&200===t.code}catch(t){throw new Error("数据库连接失败: "+t.message)}},goBack(){t()}}},[["render",function(t,h,k,f,_,m){const w=n,g=e,b=d;return c(),s(g,{class:"network-status"},{default:a((()=>[r(g,{class:"status-card"},{default:a((()=>[r(g,{class:"status-header"},{default:a((()=>[r(w,{class:"status-title"},{default:a((()=>[l("网络连接状态")])),_:1})])),_:1}),r(g,{class:"status-content"},{default:a((()=>[r(g,{class:"status-item"},{default:a((()=>[r(w,{class:"item-label"},{default:a((()=>[l("网络连接:")])),_:1}),r(w,{class:o(["item-value",_.networkStatus?"success":"error"])},{default:a((()=>[l(u(_.networkStatus?"正常":"异常"),1)])),_:1},8,["class"])])),_:1}),r(g,{class:"status-item"},{default:a((()=>[r(w,{class:"item-label"},{default:a((()=>[l("云函数连接:")])),_:1}),r(w,{class:o(["item-value",_.cloudStatus?"success":"error"])},{default:a((()=>[l(u(_.cloudStatus?"正常":"异常"),1)])),_:1},8,["class"])])),_:1}),r(g,{class:"status-item"},{default:a((()=>[r(w,{class:"item-label"},{default:a((()=>[l("数据库连接:")])),_:1}),r(w,{class:o(["item-value",_.dbStatus?"success":"error"])},{default:a((()=>[l(u(_.dbStatus?"正常":"异常"),1)])),_:1},8,["class"])])),_:1})])),_:1}),r(g,{class:"status-actions"},{default:a((()=>[r(b,{onClick:m.checkNetwork,disabled:_.checking,class:"check-btn"},{default:a((()=>[l(u(_.checking?"检测中...":"重新检测"),1)])),_:1},8,["onClick","disabled"]),r(b,{onClick:m.goBack,class:"back-btn"},{default:a((()=>[l("返回")])),_:1},8,["onClick"])])),_:1}),_.errorMessage?(c(),s(g,{key:0,class:"error-message"},{default:a((()=>[r(w,{class:"error-text"},{default:a((()=>[l(u(_.errorMessage),1)])),_:1}),r(w,{class:"error-suggestion"},{default:a((()=>[l(" 建议：如果您在国外，可能需要使用VPN或联系管理员配置国际访问。 ")])),_:1})])),_:1})):i("",!0)])),_:1})])),_:1})}],["__scopeId","data-v-db0b1503"]]);export{f as default};
